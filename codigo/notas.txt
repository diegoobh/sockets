finger i9367527
Login: i9367527       			Name: Borrallo Herrero Diego
Directory: /home/i9367527           	Shell: /bin/bash
On since Tue Dec  3 12:12 (CET) on pts/7 from 172.28.190.121
No mail.
No Plan.

finger
finger: /dev//pts/25: No such file or directory
finger: /dev//pts/28: No such file or directory
finger: /dev//pts/29: No such file or directory
finger: /dev//pts/32: No such file or directory
Login    Name                    Tty      Idle  Login Time   Office     Office Phone
andres   andres                  pts/0      23  Dec  3 08:49 (81.32.17.31)
i0830751 Del Barrio Gonzalez Be *pts/29         Dec  2 14:33 (87.220.66.180)
i0908339 Velazquez Ganoza Maria  pts/20      8  Dec  3 12:13 (172.28.136.22)
i0912274 Rodriguez Rivas Emma    pts/13      5  Dec  3 12:16 (172.20.1.210)
i0943925 Martin Santos Alvaro    pts/19         Dec  3 12:16 (172.28.198.143)
i0957477 Amor Diaz Jesus         pts/14     15  Dec  3 11:56 (10.50.22.232)
i0967600 Blazquez Delgado Alvar  pts/12      8  Dec  3 12:03 (172.20.1.159)
i0971523 Fraile De La Varga Osc  pts/11     35  Dec  3 11:45 (172.28.191.43)
i0974457 Herrero Bermejo Franci  pts/17      1  Dec  3 12:07 (172.28.197.67)
i1030074 Pereira Martinez Hugo   pts/21      8  Dec  3 12:13 (172.20.1.209)
i1120512 Fuentes Garcia Cynthia  pts/16      3  Dec  3 11:59 (172.28.195.110)
i1743074 Tocino Rio Marta       *pts/25         Dec  2 11:25 (172.28.153.29)
i1743074 Tocino Rio Marta       *pts/28         Dec  2 11:26 (172.28.153.29)
i2416951 Torres Martin Angel     pts/22      6  Dec  3 12:15 (172.28.241.74)
i5323757 Paredes Carreno Clara  *pts/32         Dec  2 15:24 (83.54.82.114)
i9367527 Borrallo Herrero Diego  pts/7          Dec  3 12:12 (172.28.190.121)

finger diegobh
finger: diegobh: no such user.

/*----------------------------------------------------------------------*/
/* A partir de aquí hay ejemplos del contenido de los archivos de nogal */ 
/*----------------------------------------------------------------------*/

// /var/log/wtmp - Info de todos los accesos al equipo
utmpdump /var/log/wtmp
Volcado utmp de /var/log/wtmp
[7] [04328] [ts/9] [i0915806] [pts/9       ] [83.55.225.58        ] [83.55.225.58   ] [2024-12-01T09:49:09,938666+00:00]
[7] [08969] [s/10] [i5323757] [pts/10      ] [83.54.82.114        ] [83.54.82.114   ] [2024-12-01T09:49:51,588021+00:00]
[8] [04328] [    ] [        ] [pts/9       ] [                    ] [0.0.0.0        ] [2024-12-01T09:52:06,613801+00:00]
[7] [03883] [ts/9] [i0967272] [pts/9       ] [213.177.204.19      ] [213.177.204.19 ] [2024-12-01T10:08:13,123823+00:00]

// Haciendo un grep para el usuario que nos interesa: 
utmpdump /var/log/wtmp | grep i9367527
Volcado utmp de /var/log/wtmp
[7] [09842] [ts/7] [i9367527] [pts/7       ] [172.28.190.121      ] [172.28.190.121 ] [2024-12-03T11:12:24,804591+00:00]
[7] [01506] [s/22] [i9367527] [pts/22      ] [79.117.136.5        ] [79.117.136.5   ] [2024-12-04T15:46:08,243276+00:00]


// /run/utmp - Registro de las sesiones de inicio de sesion actuales
utmpdump /run/utmp
Volcado utmp de /run/utmp
[8] [00257] [si  ] [        ] [            ] [                    ] [0.0.0.0        ] [2024-07-02T11:00:13,624416+00:00]
[2] [00000] [~~  ] [reboot  ] [~           ] [                    ] [0.0.0.0        ] [2024-07-02T11:00:13,625073+00:00]
[1] [20018] [~~  ] [runlevel] [~           ] [                    ] [0.0.0.0        ] [2024-07-02T11:00:13,632261+00:00]
[8] [01442] [l2  ] [        ] [            ] [                    ] [0.0.0.0        ] [2024-07-02T11:00:15,544466+00:00]
[6] [05365] [1   ] [LOGIN   ] [tty1        ] [                    ] [0.0.0.0        ] [2024-07-25T12:38:54,264922+00:00]
[6] [02145] [2   ] [LOGIN   ] [tty2        ] [                    ] [0.0.0.0        ] [2024-07-02T11:00:15,545168+00:00]
[6] [02146] [3   ] [LOGIN   ] [tty3        ] [                    ] [0.0.0.0        ] [2024-07-02T11:00:15,545338+00:00]
[6] [02147] [4   ] [LOGIN   ] [tty4        ] [                    ] [0.0.0.0        ] [2024-07-02T11:00:15,545491+00:00]
[6] [02148] [5   ] [LOGIN   ] [tty5        ] [                    ] [0.0.0.0        ] [2024-07-02T11:00:15,545672+00:00]
[6] [02149] [6   ] [LOGIN   ] [tty6        ] [                    ] [0.0.0.0        ] [2024-07-02T11:00:15,545818+00:00]
[8] [18552] [ts/0] [        ] [pts/0       ] [                    ] [85.54.193.89   ] [2024-12-03T21:37:18,808094+00:00]
[8] [18636] [ts/1] [        ] [pts/1       ] [                    ] [172.28.255.206 ] [2024-12-03T10:02:59,953702+00:00]
[7] [04137] [ts/2] [i1233163] [pts/2       ] [85.48.236.15        ] [85.48.236.15   ] [2024-12-04T15:06:52,912297+00:00]


// /var/log/lastlog - Accesos al equipo
utmpdump /var/log/lastlog
[0] [00000] [    ] [        ] [            ] [                    ] [0.0.0.0        ] [1970-01-01T00:00:00,000000+00:00]
[0] [00000] [    ] [        ] [            ] [                    ] [0.0.0.0        ] [1970-01-01T00:00:00,000000+00:00]
[0] [00000] [    ] [        ] [            ] [                    ] [0.0.0.0        ] [1970-01-01T00:00:00,000000+00:00]
[0] [00000] [    ] [        ] [            ] [                    ] [0.0.0.0        ] [1970-01-01T00:00:00,000000+00:00]


// /etc/passwd - Informacion del usuario
cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin


// who - Usuarios conectados
who
i1233163 pts/2        2024-12-04 16:06 (85.48.236.15)
i0963902 pts/4        2024-12-04 17:12 (87.221.36.186)
i0965216 pts/14       2024-12-04 17:24 (83.54.121.106)
andres   pts/19       2024-12-04 13:33 (212.128.170.64)
i0957477 pts/21       2024-12-04 16:56 (10.50.31.211)
i9367527 pts/22       2024-12-04 16:46 (79.117.136.5)


// lastlog - Lista de todos los usuarios con sus ultimos inicios de sesion 
lastlog
... (es una lista muy larga)
i1044080                                   **Nunca ha accedido**
i1959888         pts/5    172.20.1.127     mié sep 25 10:20:41 +0200 2024
i0975111         pts/1    172.20.1.159     jue oct 10 10:09:00 +0200 2024
i3910939                                   **Nunca ha accedido**
i0905047                                   **Nunca ha accedido**
i9476673         pts/11   93.156.208.59    dom nov 17 23:53:11 +0100 2024
i0962600                                   **Nunca ha accedido**
i1059102         pts/6    2.155.116.184    jue nov 28 23:15:42 +0100 2024
i8806480                                   **Nunca ha accedido**
i2323361         pts/4    172.20.1.118     mié oct 23 10:02:38 +0200 2024
i1120099                                   **Nunca ha accedido**
i7221233         pts/14   172.28.170.241   mié dic  4 10:37:02 +0100 2024
i5617352                                   **Nunca ha accedido**
i9129639                                   **Nunca ha accedido**
i0081571                                   **Nunca ha accedido**
i0834531                                   **Nunca ha accedido**
i3028904                                   **Nunca ha accedido**
i4053731                                   **Nunca ha accedido**
i0414572                                   **Nunca ha accedido**
i6524099                                   **Nunca ha accedido**
i2187875                                   **Nunca ha accedido**
i1207065         pts/29   83.58.15.5       jue nov 28 19:15:48 +0100 2024
i0014942                                   **Nunca ha accedido**
p1777056         pts/10   83.55.78.115     jue nov 28 11:07:09 +0100 2024
i7507527                                   **Nunca ha accedido**
i1526100                                   **Nunca ha accedido**
i3948539                                   **Nunca ha accedido**


// getent passwd [usuario] - Info adicional a /etc/passwd pero parecido 
getent passwd i9367527
i9367527:x:33920:10002:Borrallo Herrero Diego:/home/i9367527:/bin/bash



// Plan para obtener info específica del usuario(si existe el usuario):
Login desde getent 
Name desde getent 
Directory desde getent 
Shell desde getent 
TTY desde wtmp o lastlog
IP desde wtmp o lastlog
Tiempo de conexion desde lastlog
Mail (revisar)
Plan (revisar)

// Plan para obtener info de todos los usuarios
Login desde who 
Nombre desde getent (ir haciendo uno a uno creo)
TTY desde wtmp o lastlog 
Idle desde lastlog creo 
Login time desde lastlog creo
Office(IP) desde wtmp o lastlog
Office Phone suele estar vacío